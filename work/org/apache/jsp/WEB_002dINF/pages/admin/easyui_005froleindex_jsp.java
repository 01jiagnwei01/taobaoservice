/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: Apache Tomcat/7.0.54
 * Generated at: 2014-11-30 07:39:20 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp.WEB_002dINF.pages.admin;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;
import com.gxkj.common.util.SystemGlobals;
import java.util.*;
import com.gxkj.taobaoservice.entitys.*;
import com.gxkj.common.util.SystemGlobals;

public final class easyui_005froleindex_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  static {
    _jspx_dependants = new java.util.HashMap<java.lang.String,java.lang.Long>(1);
    _jspx_dependants.put("/WEB-INF/pages/admin/../common/easyui-html5.jsp", Long.valueOf(1417330918970L));
  }

  private javax.el.ExpressionFactory _el_expressionfactory;
  private org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public void _jspInit() {
    _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
    _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
  }

  public void _jspDestroy() {
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
        throws java.io.IOException, javax.servlet.ServletException {

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html; charset=UTF-8");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write("\r\n");
      out.write("\r\n");
      out.write(" <!DOCTYPE html>\r\n");
      out.write("<html lang=\"zh\">\r\n");
      out.write("<head>");
      out.write("\r\n");
      out.write("<meta http-equiv=\"X-UA-Compatible\" content=\"IE=EmulateIE8\" content=\"ie=edge\"/>\r\n");
      out.write("<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">\r\n");
      out.write("<title>角色管理信息</title>\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("<link rel=\"stylesheet\" type=\"text/css\" href=\"");
      out.print(request.getContextPath() );
      out.write("/resources/icon/icon.css?3\">\r\n");
      out.write("<link rel=\"stylesheet\" type=\"text/css\" href=\"");
      out.print(request.getContextPath() );
      out.write("/resources/easyui/themes/default/easyui.css\">\r\n");
      out.write("<link rel=\"stylesheet\" type=\"text/css\" href=\"");
      out.print(request.getContextPath() );
      out.write("/resources/easyui/themes/icon.css\">\r\n");
      out.write("<script type=\"text/javascript\" src=\"");
      out.print(request.getContextPath() );
      out.write("/resources/easyui/jquery-1.10.2.min.js\"></script>\r\n");
      out.write("<script type=\"text/javascript\" src=\"");
      out.print(request.getContextPath() );
      out.write("/resources/easyui/jquery.easyui.min.js\"></script>\r\n");
      out.write("<script type=\"text/javascript\" src=\"");
      out.print(request.getContextPath() );
      out.write("/resources/easyui/locale/easyui-lang-zh_CN.js\"></script>\r\n");
      out.write("<style type=\"text/css\">\r\n");
      out.write("\t.mask {  \r\n");
      out.write("            position: absolute; top: 0px; filter: alpha(opacity=60); background-color: #777;\r\n");
      out.write("            z-index: 1002; left: 0px;\r\n");
      out.write("            opacity:0.5; -moz-opacity:0.5;\r\n");
      out.write("        }\r\n");
      out.write("</style>\r\n");
      out.write("<script type=\"text/javascript\">\r\n");
      out.write("\t function getPageArea() {\r\n");
      out.write("\t\tif (document.compatMode == 'BackCompat') {\r\n");
      out.write("\t\t\treturn {\r\n");
      out.write("\t\t\t\twidth: Math.max(document.body.scrollWidth, document.body.clientWidth),\r\n");
      out.write("\t\t\t\theight: Math.max(document.body.scrollHeight, document.body.clientHeight)\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t} else {\r\n");
      out.write("\t\t\treturn {\r\n");
      out.write("\t\t\t\twidth: Math.max(document.documentElement.scrollWidth, document.documentElement.clientWidth),\r\n");
      out.write("\t\t\t\theight: Math.max(document.documentElement.scrollHeight, document.documentElement.clientHeight)\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t}\r\n");
      out.write("\t}\r\n");
      out.write("\tjQuery.extend({ \r\n");
      out.write("\t\tshowMask: function(el, msg) {\r\n");
      out.write("\t\t\tif(!el)el =document.body;\r\n");
      out.write("\t\t\tvar _1c3=$(el);\r\n");
      out.write("\t\t\tmsg = msg?msg:\"\";\r\n");
      out.write("\t\t\tif(!_1c3.children(\"div.datagrid-mask\").length){\r\n");
      out.write("\t\t\t\t$(\"<div class=\\\"datagrid-mask\\\" style=\\\"display:block\\\"></div>\").appendTo(_1c3);\r\n");
      out.write("\t\t\t\tvar msg=$(\"<div class=\\\"datagrid-mask-msg\\\" style=\\\"display:block;left:50%\\\"></div>\").html(msg).appendTo(_1c3);\r\n");
      out.write("\t\t\t\tmsg.css(\"marginLeft\",-msg.outerWidth()/2);\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t}, \r\n");
      out.write("\t\thideMask: function(el){ \r\n");
      out.write("\t\t\tif(!el)el =document.body;\r\n");
      out.write("\t\t   var _1c4=$(el);\r\n");
      out.write("\t\t   \tvar mask = _1c4.children(\"div.datagrid-mask-msg\");\r\n");
      out.write("\t\t   \tif(mask){\r\n");
      out.write("\t\t   \t\t_1c4.children(\"div.datagrid-mask-msg\").remove();\r\n");
      out.write("\t\t\t\t_1c4.children(\"div.datagrid-mask\").remove();\r\n");
      out.write("\t\t   \t}\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t} \r\n");
      out.write("\t});\r\n");
      out.write("</script>");
      out.write("\r\n");
      out.write("</head>\r\n");
      out.write("<body class=\"easyui-layout\">\r\n");
      out.write("\t <div data-options=\"region:'center'\">\r\n");
      out.write("\t\t<table id=\"dg\"></table>\r\n");
      out.write("\t</div>\r\n");
      out.write("\t<!-- 工具条  -->\r\n");
      out.write("\t<div id=\"tb\" style=\"padding:5px;height:auto\">\r\n");
      out.write("\t\t<div style=\"margin-bottom:5px\">\r\n");
      out.write("\t\t\t<table width=\"100%\">\r\n");
      out.write("\t\t\t<tr width=\"100%\">\r\n");
      out.write("\t\t\t\t<td width=\"50%\">\r\n");
      out.write("\t\t\t\t\t角色名称: <input class=\"easyui-spinner\" style=\"line-height:12px; width:200px\" id=\"role_Name\"/>\r\n");
      out.write("\t\t\t\t\t<!-- \r\n");
      out.write("\t\t\t\t\t状态:<select class=\"easyui-combobox\" data-options=\"editable:false,panelHeight:'auto'\" style=\"width:100px\" id=\"role_status\">\r\n");
      out.write("\t\t\t\t\t\t<option value=\"0\">不限</option>\r\n");
      out.write("\t\t\t\t\t\t<option value=\"1\">有效</option>\r\n");
      out.write("\t\t\t\t\t\t<option value=\"2\">待审核</option>\r\n");
      out.write("\t\t\t\t\t\t<option value=\"3\">锁定</option>\r\n");
      out.write("\t\t\t\t\t</select> -->\r\n");
      out.write("\t\t\t\t\t<a href=\"#\"  class=\"easyui-linkbutton\" iconCls=\"icon-search\" onclick=\"searchFn()\">查询</a>\r\n");
      out.write("\t\t\t\t</td>\r\n");
      out.write("\t\t\t\t<td align=\"right\" width=\"50%\">\r\n");
      out.write("\t\t\t\t\t<a id=\"addBtn\" href=\"#\" class=\"easyui-linkbutton\" iconCls=\"add_btn\" plain=\"true\" onclick=\"addFn()\">增加</a>\r\n");
      out.write("\t\t\t\t</td>\r\n");
      out.write("\t\t\t</tr>\r\n");
      out.write("\t\t</table>\r\n");
      out.write("\t\t</div>\r\n");
      out.write("\t</div>\r\n");
      out.write("\t<!-- 弹出窗口  -->\r\n");
      out.write("\t<div id=\"w\" class=\"easyui-window\"  \r\n");
      out.write("\t\tdata-options=\"modal:true,closed:true,iconCls:'icon-save',\r\n");
      out.write("\t\tcollapsible:false,minimizable:false,maximizable:false,resizable:false\" \r\n");
      out.write("\t\t\tstyle=\"width:500px;height:420px;padding:10px;\">\r\n");
      out.write("\t\t\t<div class=\"easyui-layout\" data-options=\"fit:true\">\r\n");
      out.write("\t\t\t\t<form id=\"role_form\">\r\n");
      out.write("\t\t\t\t\t<div data-options=\"region:'center',border:false\" style=\"padding:10px;\">\r\n");
      out.write("\t\t\t\t\t\t<div class=\"easyui-tabs\" data-options=\"fit:true,border:false,plain:true\">\r\n");
      out.write("\t\t\t\t\t\t\t<div title=\"基本信息\" style=\"padding:10px\">\r\n");
      out.write("\t\t\t\t\t\t\t\t<table>\r\n");
      out.write("\t\t\t\t\t\t\t\t\t<tr style=\"display: none;\">\r\n");
      out.write("\t\t\t\t\t\t    \t\t\t<td>角色id:</td>\r\n");
      out.write("\t\t\t\t\t\t    \t\t\t<td><input  type=\"text\" id=\"form_role_id\" ></input></td>\r\n");
      out.write("\t\t\t\t\t\t    \t\t</tr>\r\n");
      out.write("\t\t\t\t\t\t    \t\t<tr style=\"display: none;\">\r\n");
      out.write("\t\t\t\t\t\t    \t\t\t<td>角色状态:</td>\r\n");
      out.write("\t\t\t\t\t\t    \t\t\t<td><input  type=\"text\" id=\"form_role_status\" name=\"status\"></input></td>\r\n");
      out.write("\t\t\t\t\t\t    \t\t</tr>\r\n");
      out.write("\t\t\t\t\t\t    \t\t<tr>\r\n");
      out.write("\t\t\t\t\t\t    \t\t\t<td>角色名称:</td>\r\n");
      out.write("\t\t\t\t\t\t    \t\t\t<td><input class=\"easyui-validatebox\" type=\"text\" id=\"form_role_name\" data-options=\"prompt:'请输入角色名称.',required:true,validType:'length[2,10]'\"></input></td>\r\n");
      out.write("\t\t\t\t\t\t    \t\t</tr>\r\n");
      out.write("\t\t\t\t\t\t    \t</table>\r\n");
      out.write("\t\t\t\t\t\t\t</div> \r\n");
      out.write("\t\t\t\t\t\t\t<div title=\"资源授权\" style=\"padding:10px\">\r\n");
      out.write("\t\t\t\t\t\t\t\t <ul id='tt' class=\"easyui-tree\" data-options=\"url:  '");
      out.print(request.getContextPath() );
      out.write("/admin/menu/list?d='+new Date().getTime(),loadFilter:function (data){ return makeTreeData( data,true);},method:'get',animate:true,checkbox:true,cascadeCheck:true\"></ul>\r\n");
      out.write("\t\t\t\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t\t</div>\r\n");
      out.write("\r\n");
      out.write("\t\t\t\t\t<div data-options=\"region:'south',border:false\" style=\"text-align:right;padding:5px 0 0;\">\r\n");
      out.write("\t\t\t\t\t\t<a class=\"easyui-linkbutton\" data-options=\"iconCls:'icon-ok'\" href=\"javascript:void(0)\" onclick=\"javascript:submitForm()\">保存</a>\r\n");
      out.write("\t\t\t\t\t\t<a class=\"easyui-linkbutton\" data-options=\"iconCls:'icon-cancel'\" href=\"javascript:void(0)\" onclick=\"javascript:closeWinFn()\">取消</a>\r\n");
      out.write("\t\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t</form>\r\n");
      out.write("\t\t\t</div>\r\n");
      out.write("\t</div>\r\n");
      out.write("<script type=\"text/javascript\">\r\n");
      out.write("var roledoadd = \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${_adminUser_.btnMap.roledoadd}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("\"?true:false;\r\n");
      out.write("var roledoupdate = \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${_adminUser_.btnMap.roledoupdate}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("\"?true:false;\r\n");
      out.write("var rolesetstatus = \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${_adminUser_.btnMap.rolesetstatus}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("\"?true:false;\r\n");
      out.write("var roledopage = \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${_adminUser_.btnMap.roledopage}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("\"?true:false;\r\n");
      out.write("var roleget = \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${_adminUser_.btnMap.roleget}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("\"?true:false;\r\n");
      out.write("\t\tvar authoritydata = [];\r\n");
      out.write("\t\tvar saveType=\"add\";\r\n");
      out.write("\t\t$(function(){\r\n");
      out.write("\t\t\tif(!roledoadd){\r\n");
      out.write("\t\t\t\t$(\"#addBtn\").hide();\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t\t$('#dg').datagrid({\r\n");
      out.write("\t\t\t \tborder:false,\r\n");
      out.write("\t\t\t\trownumbers:true,\r\n");
      out.write("\t\t\t\tcheckOnSelect:true,\r\n");
      out.write("\t\t\t\tfitColumns:true,\r\n");
      out.write("\t\t\t\tpagination:true,\r\n");
      out.write("\t\t\t\tsingleSelect:true,\r\n");
      out.write("\t\t\t\tfit:true,\r\n");
      out.write("\t\t\t\tpageSize:20,\r\n");
      out.write("\t\t\t\tmethod:'get',\r\n");
      out.write("\t\t\t  \turl:'");
      out.print(request.getContextPath() );
      out.write("/admin/role/dopage?d='+new Date().getTime(),\r\n");
      out.write("\t\t\t  \tqueryParams:{ },\r\n");
      out.write("\t\t\t  \tonBeforeLoad:function(param){\r\n");
      out.write("\t\t\t\t\tparam['pageno'] =  param['page']-1;\r\n");
      out.write("\t\t\t\t\tparam['pagesize']  = param['rows'];\r\n");
      out.write("\t\t\t\t\t\r\n");
      out.write("\t\t\t  \t\treturn true ;\r\n");
      out.write("\t\t\t  \t},\r\n");
      out.write("\t\t\t  \tonDblClickRow:function(rowIndex, rowData){\r\n");
      out.write("\t\t\t  \t\t\t//updateRowIndex = rowIndex;\r\n");
      out.write("\t\t\t\t\t\t//getRoleInfoById(rowData['roleId']);\t\r\n");
      out.write("\t\t\t  \t},\r\n");
      out.write("\t\t\t  \tonLoadError:function(){\r\n");
      out.write("\t\t\t  \t}, \r\n");
      out.write("\t\t\t  \t\r\n");
      out.write("\t\t\t\tcolumns:[[ \r\n");
      out.write("\t\t\t\t\t{field:'id',title:'id'},\r\n");
      out.write("\t\t\t\t\t{field:'name',title:'角色名' ,width:100},\r\n");
      out.write("\t\t\t\t\t{field:'status',title:'状态',width:100,formatter:function(value,row,index){\r\n");
      out.write("\t\t\t\t\t\tif(value == 1){\r\n");
      out.write("\t\t\t\t\t\t\treturn \"有效\";\r\n");
      out.write("\t\t\t\t\t\t}else if(value == 2){\r\n");
      out.write("\t\t\t\t\t\t\treturn \"待审核\";\r\n");
      out.write("\t\t\t\t\t\t}else if(value == 3){\r\n");
      out.write("\t\t\t\t\t\t\treturn \"锁定\";\r\n");
      out.write("\t\t\t\t\t\t}else if(value == 4){\r\n");
      out.write("\t\t\t\t\t\t\treturn \"删除\";\r\n");
      out.write("\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t}},\r\n");
      out.write("\t\t\t\t\t{field:'opt',title:'操作' ,width:100,formatter:optFormat}\r\n");
      out.write("\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\t \r\n");
      out.write("\t\t\t\t]],\r\n");
      out.write("\t\t\t\ttoolbar: '#tb',\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\tloadFilter:function(data){\r\n");
      out.write("\t\t\t\t\tdata.total = data.totalPage;\r\n");
      out.write("\t\t\t\t\tdata.rows = $.isArray(data.pageData)?data.pageData:[];\r\n");
      out.write("\t\t\t\t\treturn data;\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t});\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\tvar pager = $('#dg').datagrid(\"getPager\");\r\n");
      out.write("\t\t\tpager.pagination({\r\n");
      out.write("\t\t\t\t'onBeforeRefresh':function(){\r\n");
      out.write("\t\t\t\t\tsearchFn(); \r\n");
      out.write("\t\t\t\t\treturn false;\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t}); \r\n");
      out.write("\t\t});\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tfunction searchFn(){\r\n");
      out.write("\t\t\tif(!roledopage){\r\n");
      out.write("\t\t\t $.messager.alert('系统提示','您没有权限访问!','info');\r\n");
      out.write("\t\t\treturn;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t\tvar role_Name = $(\"#role_Name\").val();\r\n");
      out.write("\t\t\t//var role_status = $('#role_status').combobox('getValue');\r\n");
      out.write("\t\t\t$('#dg').datagrid('load',{\r\n");
      out.write("\t\t\t\t\t//status:role_status,\r\n");
      out.write("\t\t\t\t\tname:role_Name,\r\n");
      out.write("\t\t\t\t\td:new Date().getTime()\r\n");
      out.write("\t\t\t});\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tvar resource_dg_loadSuccess = false;\r\n");
      out.write("\t\tvar updateRowIndex = -1;\r\n");
      out.write("\t\tfunction addFn(){\r\n");
      out.write("\t\t\t  saveType = \"add\";\r\n");
      out.write("\t\t\t  $(\"#form_role_name\").val(\"\");\r\n");
      out.write("\t\t\t  $('#tt').tree(\"reload\");\r\n");
      out.write("\t\t\t  $('#w').window('open').panel('setTitle',\"增加角色\");\r\n");
      out.write("\t\t\t  var nodes = $('#tt').tree('getChecked', ['checked','indeterminate']);\r\n");
      out.write("\t\t   \t\tfor(var i=0;i<nodes.length;i++){\r\n");
      out.write("\t\t   \t\t\tvar node = nodes[i];\r\n");
      out.write("\t\t   \t\t\tif(node  && $('#tt').tree(\"isLeaf\",node.target)){\r\n");
      out.write("\t\t   \t\t\t\t$('#tt').tree('uncheck',node.target);\r\n");
      out.write("\t\t   \t\t\t}\r\n");
      out.write("\t\t   \t\t}\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tfunction delFn(id){\r\n");
      out.write("\t\t\t \r\n");
      out.write("\t\t\t$.messager.confirm('系统提示', '您确定要删除该条记录吗?', function(r){\r\n");
      out.write("\t\t\tif (r){\r\n");
      out.write("\t\t\t\t\tvar url = \"");
      out.print(request.getContextPath() );
      out.write("/admin/role/setstatus\";\r\n");
      out.write("\t\t  \t \t\t$.ajax({\r\n");
      out.write("\t\t\t  \t  \t  type:'post',\r\n");
      out.write("\t\t\t\t\t  url: url,\r\n");
      out.write("\t\t\t\t\t  context: document.body,\r\n");
      out.write("\t\t\t\t\t  data:{\r\n");
      out.write("\t\t\t\t\t  \tids: id,\r\n");
      out.write("\t\t\t\t\t  \tstatus:4\r\n");
      out.write("\t\t\t\t\t  },\r\n");
      out.write("\t\t\t\t\t  success:function(json){\r\n");
      out.write("\t\t\t\t\t \t//json = jQuery.parseJSON(json)\r\n");
      out.write("\t\t\t\t\t  \tif(json[\"success\"]){\r\n");
      out.write("\t\t\t\t\t\t\tvar row = null;\r\n");
      out.write("\t\t\t\t\t\t\tvar rows = $(\"#dg\").datagrid(\"getRows\");\r\n");
      out.write("\t\t\t\t\t\t\tfor(var i=0;i<rows.length;i++){\r\n");
      out.write("\t\t\t\t\t\t\t\tif(rows[i]['id'] == id){\r\n");
      out.write("\t\t\t\t\t\t\t\t\trow = rows[i];\r\n");
      out.write("\t\t\t\t\t\t\t\t\tvar rowIndex = \t$('#dg').datagrid(\"getRowIndex\",row);\r\n");
      out.write("\t\t\t\t\t\t\t\t\t$('#dg').datagrid(\"deleteRow\",rowIndex);\r\n");
      out.write("\t\t\t\t\t\t\t\t\tbreak;\r\n");
      out.write("\t\t\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t  \t\t \r\n");
      out.write("\t\t\t\t\t  \t\t$.messager.alert('系统提示','删除成功!','info');\r\n");
      out.write("\t\t\t\t\t  \t \r\n");
      out.write("\t\t\t\t\t  \t}else{\r\n");
      out.write("\t\t\t\t\t  \t\t$.messager.alert('系统提示','删除失败，请刷新后重试!','error');\r\n");
      out.write("\t\t\t\t\t  \t}\r\n");
      out.write("\t\t\t\t\t  \t \r\n");
      out.write("\t\t\t\t\t  \r\n");
      out.write("\t\t\t\t\t  },\r\n");
      out.write("\t\t\t\t\t  error:function(xhr,textStatus,errorThrown){\r\n");
      out.write("\t\t\t\t\t  \tvar responseText = xhr.responseText;\r\n");
      out.write("\t\t\t\t\t  \t$.messager.alert('系统提示','删除失败，请刷新后重试!','error');\r\n");
      out.write("\t\t\t\t\t  \r\n");
      out.write("\t\t\t\t\t  } \r\n");
      out.write("\t\t\t\t});\r\n");
      out.write("\t\t\t\t\t \r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t});\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tfunction optFormat (value,row,index){\r\n");
      out.write("\t\t\tvar btns = [];\r\n");
      out.write("\t\t\tif(roledoupdate){\r\n");
      out.write("\t\t\t\tbtns.push('<a class=\"easyui-linkbutton l-btn l-btn-plain\" onclick=\"updateFn(\\''+row['id']+'\\')\" href=\"#\" plain=\"true\" iconCls=\"update_btn\"><span class=\"l-btn-left\"><span class=\"l-btn-text update_btn l-btn-icon-left\">修改</span></span></a>');\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t\tif(rolesetstatus){\r\n");
      out.write("\t\t\t\tbtns.push('<a class=\"easyui-linkbutton l-btn l-btn-plain\" onclick=\"delFn(\\''+row['id']+'\\')\" href=\"#\" plain=\"true\" iconCls=\"del_btn\"><span class=\"l-btn-left\"><span class=\"l-btn-text del_btn l-btn-icon-left\">删除</span></span></a>');\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t\treturn btns.join(\"&nbsp;\");\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tfunction updateFn(id){\r\n");
      out.write("\t\t\tupdateRowIndex = -1;\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\tvar rows = $(\"#dg\").datagrid(\"getRows\");\r\n");
      out.write("\t\t\tvar row = null;\r\n");
      out.write("\t\t\tfor(var i=0;i<rows.length;i++){\r\n");
      out.write("\t\t\t\tif(rows[i]['id'] == id){\r\n");
      out.write("\t\t\t\t\trow = rows[i];\r\n");
      out.write("\t\t\t\t\tbreak;\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\tvar rowIndex =  $('#dg').datagrid(\"getRowIndex\",row);\r\n");
      out.write("\t\t\t updateRowIndex = rowIndex;\r\n");
      out.write("\t\t\t getRoleInfoById(row['id']);\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tfunction submitForm(){\r\n");
      out.write("\t\t\t var isValidate = $('#role_form').form('validate');\r\n");
      out.write("\t\t\t if(!isValidate){\r\n");
      out.write("\t\t\t \t$.messager.alert('系统提示','请确保填写正确!','warning');\r\n");
      out.write("\t\t\t \treturn;\r\n");
      out.write("\t\t\t }\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\tvar form_role_name = $.trim($(\"#form_role_name\").val());\r\n");
      out.write("\t\t\tvar selections = $('#tt').tree('getChecked',['checked','indeterminate']);\r\n");
      out.write("\t\t\t  \r\n");
      out.write("\t\t\tif(form_role_name.length ==0 ){\r\n");
      out.write("\t\t\t\t$.messager.alert('系统提示','角色名称不能为空!','warning');\r\n");
      out.write("\t\t\t\treturn;\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\tvar ids = [];\r\n");
      out.write("\t\t\tfor(var i=0;i<selections.length;i++){\r\n");
      out.write("\t\t\t\tids.push(selections[i][\"id\"]);\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t\t \r\n");
      out.write("\t\t\tif(saveType == 'add'){\r\n");
      out.write("\t\t\t\taddRoleInDB(form_role_name,ids.join(\",\"));\r\n");
      out.write("\t\t\t}else if(saveType == 'update'){\r\n");
      out.write("\t\t\t \tvar roleId = $(\"#form_role_id\").val();\r\n");
      out.write("\t\t\t \tvar rolestatus = $(\"#form_role_status\").val();\r\n");
      out.write("\t\t\t \tupdateRoleInDB(roleId,form_role_name,ids.join(\",\"),rolestatus);\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tfunction closeWinFn(){\r\n");
      out.write("\t\t\t$('#w').window('close');\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t \r\n");
      out.write("\t\tfunction addRoleInDB(roleName,authoritiesIds){\r\n");
      out.write("\t\t\tvar url =  \"");
      out.print(request.getContextPath() );
      out.write("/admin/role/doadd\";\r\n");
      out.write("\t\t  \t $.ajax({\r\n");
      out.write("\t\t  \t  \t  type:'post',\r\n");
      out.write("\t\t\t\t  url: url,\r\n");
      out.write("\t\t\t\t  context: document.body,\r\n");
      out.write("\t\t\t\t  data:{\r\n");
      out.write("\t\t\t\t  \tname:roleName,\r\n");
      out.write("\t\t\t\t  \tstatus:1,\r\n");
      out.write("\t\t\t\t  \tmenuIds: authoritiesIds\r\n");
      out.write("\t\t\t\t  },\r\n");
      out.write("\t\t\t\t  success:function(json){\r\n");
      out.write("\t\t\t\t   \t//\tjson = $.parseJSON(json);\r\n");
      out.write("\t\t\t\t \t $('#dg').datagrid('appendRow',json);\r\n");
      out.write("\t\t\t\t \t $.messager.alert('系统提示','保存成功!','info',closeWinFn);\r\n");
      out.write("\t\t\t\t\t\r\n");
      out.write("\t\t\t\t  },\r\n");
      out.write("\t\t\t\t  error:function(xhr,textStatus,errorThrown){\r\n");
      out.write("\t\t\t\t  \t\tvar responseText = xhr.responseText;\r\n");
      out.write("\t\t\t\t    \t$.messager.alert('系统提示','保存失败，请刷新后重试!','error');\r\n");
      out.write("\t\t\t\t  \r\n");
      out.write("\t\t\t\t  } \r\n");
      out.write("\t\t\t});\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tfunction updateRoleInDB(roleId,roleName,authoritiesIds,rolestatus){\r\n");
      out.write("\t\t\tvar url = \"");
      out.print(request.getContextPath() );
      out.write("/admin/role/doupdate\";\r\n");
      out.write("\t\t  \t $.ajax({\r\n");
      out.write("\t\t  \t  \t  type:'post',\r\n");
      out.write("\t\t\t\t  url: url,\r\n");
      out.write("\t\t\t\t  context: document.body,\r\n");
      out.write("\t\t\t\t  data:{\r\n");
      out.write("\t\t\t\t  \tid:roleId,\r\n");
      out.write("\t\t\t\t  \tname:roleName,\r\n");
      out.write("\t\t\t\t  \tstatus:rolestatus,\r\n");
      out.write("\t\t\t\t  \tmenuIds: authoritiesIds\r\n");
      out.write("\t\t\t\t  },\r\n");
      out.write("\t\t\t\t  success:function(json){\r\n");
      out.write("\t\t\t\t  \t//json = $.parseJSON(json);\r\n");
      out.write("\t\t\t\t  \t $('#dg').datagrid('updateRow',{\r\n");
      out.write("\t\t\t\t  \t \tindex:updateRowIndex,\r\n");
      out.write("\t\t\t\t  \t \trow:json\r\n");
      out.write("\t\t\t\t  \t });\r\n");
      out.write("\t\t\t\t  \t  $('#dg').datagrid('selectRow',updateRowIndex);\r\n");
      out.write("\t\t\t\t  \t \r\n");
      out.write("\t\t\t\t  \t closeWinFn();\r\n");
      out.write("\t\t\t\t \t $.messager.alert('系统提示','保存成功!','info');\r\n");
      out.write("\t\t\t\t  \r\n");
      out.write("\t\t\t\t  },\r\n");
      out.write("\t\t\t\t  error:function(xhr,textStatus,errorThrown){\r\n");
      out.write("\t\t\t\t  \tvar responseText = xhr.responseText;\r\n");
      out.write("\t\t\t\t  \t$.messager.alert('系统提示','保存失败，请刷新后重试!','error');\r\n");
      out.write("\t\t\t\t  \r\n");
      out.write("\t\t\t\t  } \r\n");
      out.write("\t\t\t\t});\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tfunction getRoleInfoById(roldId){\r\n");
      out.write("\t\t\tvar url =  \"");
      out.print(request.getContextPath() );
      out.write("/admin/role/get?d=\"+new Date().getTime();\r\n");
      out.write("\t\t  \t $.ajax({\r\n");
      out.write("\t\t\t  url: url,\r\n");
      out.write("\t\t\t  context: document.body,\r\n");
      out.write("\t\t\t  data:{\r\n");
      out.write("\t\t\t  \t id:roldId\r\n");
      out.write("\t\t\t  },\r\n");
      out.write("\t\t\t  success:function(json){\r\n");
      out.write("\t\t\t \t// var json_str = JSON2.stringify(json);\r\n");
      out.write("\t\t\t \tif(!json){\r\n");
      out.write("\t\t\t \t\t$.messager.alert('系统提示','获取数据失败，请刷新后重试!','error');\r\n");
      out.write("\t\t\t \t\treturn;\r\n");
      out.write("\t\t\t \t}\r\n");
      out.write("\t\t\t \t//json = jQuery.parseJSON(json)\r\n");
      out.write("\t\t\t  \t showUpdateWin(json);\r\n");
      out.write("\t\t\t  \r\n");
      out.write("\t\t\t  },\r\n");
      out.write("\t\t\t  error:function(xhr,textStatus,errorThrown){\r\n");
      out.write("\t\t\t  \tvar responseText = xhr.responseText;\r\n");
      out.write("\t\t\t  \t$.messager.alert('系统提示','获取数据失败，请刷新后重试!','error');\r\n");
      out.write("\t\t\t  \r\n");
      out.write("\t\t\t  } \r\n");
      out.write("\t\t\t});\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tfunction showUpdateWin(role){\r\n");
      out.write("\t\t\tsaveType = \"update\";\r\n");
      out.write("\t\t\t//$('#tt').tree(\"reload\");\r\n");
      out.write("\t\t\t$('#w').window('open').panel('setTitle',\"修改角色\");\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t$(\"#form_role_name\").val(role[\"name\"]);\r\n");
      out.write("\t\t\t$(\"#form_role_id\").val(role[\"id\"]);\r\n");
      out.write("\t\t\t$(\"#form_role_status\").val(role[\"status\"]);\r\n");
      out.write("\t\t\t \r\n");
      out.write("\t\t   \t\tvar nodes = $('#tt').tree('getChecked', ['checked','indeterminate']);\r\n");
      out.write("\t\t   \t\t \r\n");
      out.write("\t\t   \t\tfor(var i=0;i<nodes.length;i++){\r\n");
      out.write("\t\t   \t\t\tvar node = nodes[i];\r\n");
      out.write("\t\t   \t\t\tif(node  && $('#tt').tree(\"isLeaf\",node.target)){\r\n");
      out.write("\t\t   \t\t\t\t$('#tt').tree('uncheck',node.target);\r\n");
      out.write("\t\t   \t\t\t}\r\n");
      out.write("\t\t   \t\t}\r\n");
      out.write("\t\t   \t\t \r\n");
      out.write("\t\t   \t\tvar menus = role[\"relMenus\"];\r\n");
      out.write("\t\t   \t\t\r\n");
      out.write("\t\t   \t\tfor(var i=0,l=menus.length;i<l;i++){\r\n");
      out.write("\t\t   \t\t\tvar treeId = menus[i]['id'];\r\n");
      out.write("\t\t   \t\t\tvar treeNode =  $('#tt').tree('find', treeId);\r\n");
      out.write("\t\t   \t\t\t \r\n");
      out.write("\t\t   \t\t\tif(treeNode  && $('#tt').tree(\"isLeaf\",treeNode.target)){\r\n");
      out.write("\t\t   \t\t\t\t$('#tt').tree('check', treeNode.target);\r\n");
      out.write("\t\t   \t\t\t}\r\n");
      out.write("\t\t   \t\t\t\r\n");
      out.write("\t\t   \t\t}\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t function makeTreeData(menus,usecheck){\r\n");
      out.write("\r\n");
      out.write("\tif(menus.length==0)return menus;\r\n");
      out.write(" \t var mapdata = {};\r\n");
      out.write("\t  //第一次组织树节点内容\r\n");
      out.write("\t  for(var i=0;i<menus.length;i++)\r\n");
      out.write("\t  {\r\n");
      out.write("\t      var node = menus[i];\r\n");
      out.write("\t      var menuname = node['name'];\r\n");
      out.write("\t      var pid = node['pid'];\r\n");
      out.write("\t      var aid = node['id'] ;\r\n");
      out.write("\t      \r\n");
      out.write("\t      var path = node['path'];\r\n");
      out.write("\t      var isbutton = node['isbutton'];\r\n");
      out.write("\t      var btnflag = node[\"btnflag\"];\r\n");
      out.write("\t\t\tvar obj = {\r\n");
      out.write("\t    \t\t  id:aid,\r\n");
      out.write("\t    \t\t  text:menuname,\r\n");
      out.write("\t    \t\t // \"iconCls\":isbutton!=1?\"tree-file\":\"icon-add\",\r\n");
      out.write("\t    \t\t  \r\n");
      out.write("\t    \t\t  attributes:{\r\n");
      out.write("\t    \t\t  \tpath:path,\r\n");
      out.write("\t    \t\t  \tisbutton:isbutton,\r\n");
      out.write("\t    \t\t  \tbtnflag:btnflag,\r\n");
      out.write("\t    \t\t  \tpid:pid\r\n");
      out.write("\t    \t\t  }\r\n");
      out.write("\t    \t\t  \r\n");
      out.write("\t    \t\t};\r\n");
      out.write("\t    \t\tif(isbutton==1){\r\n");
      out.write("\t    \t\t\tobj['iconCls'] = 'icon-add';\r\n");
      out.write("\t    \t\t}\r\n");
      out.write("\t      mapdata[\"id_\"+aid]= obj;\r\n");
      out.write("\t     if(usecheck)\r\n");
      out.write("\t\t {\r\n");
      out.write("\t\t \tmapdata[\"id_\"+aid]['checked']=false;\r\n");
      out.write("\t\t }\r\n");
      out.write("\r\n");
      out.write("\t  }\r\n");
      out.write("  var ret = [];\r\n");
      out.write("  for(var key in mapdata)\r\n");
      out.write("  {\r\n");
      out.write("      var node = mapdata[key];\r\n");
      out.write("      var pid = mapdata[key]['attributes']['pid'];\r\n");
      out.write("      if(mapdata[\"id_\"+pid])\r\n");
      out.write("      {\r\n");
      out.write("          if(typeof mapdata[\"id_\"+pid]['children'] == 'undefined')\r\n");
      out.write("          {\r\n");
      out.write("              mapdata[\"id_\"+pid]['children'] = [];\r\n");
      out.write("          }\r\n");
      out.write("          mapdata[\"id_\"+pid]['children'].push(mapdata[key]);\r\n");
      out.write("      }else\r\n");
      out.write("      {\r\n");
      out.write("          ret.push(mapdata[key]);\r\n");
      out.write("      }\r\n");
      out.write("  }\r\n");
      out.write("  return ret;\r\n");
      out.write("}\r\n");
      out.write("\t\t\r\n");
      out.write("\t</script>\r\n");
      out.write("</body>\r\n");
      out.write("</html>");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try { out.clearBuffer(); } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
