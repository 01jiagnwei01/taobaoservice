/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: Apache Tomcat/7.0.54
 * Generated at: 2014-11-30 07:21:35 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp.WEB_002dINF.pages.admin;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;
import com.gxkj.common.util.SystemGlobals;
import com.gxkj.common.util.SystemGlobals;

public final class menuindex_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  static {
    _jspx_dependants = new java.util.HashMap<java.lang.String,java.lang.Long>(1);
    _jspx_dependants.put("/WEB-INF/pages/admin/../common/easyui-html5.jsp", Long.valueOf(1417330918970L));
  }

  private javax.el.ExpressionFactory _el_expressionfactory;
  private org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public void _jspInit() {
    _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
    _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
  }

  public void _jspDestroy() {
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
        throws java.io.IOException, javax.servlet.ServletException {

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html; charset=UTF-8");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write("\r\n");
      out.write(" \r\n");
      out.write(" <!DOCTYPE html>\r\n");
      out.write("<html lang=\"zh\">\r\n");
      out.write("<head>");
      out.write("\r\n");
      out.write("<meta http-equiv=\"X-UA-Compatible\" content=\"IE=EmulateIE8\" content=\"ie=edge\"/>\r\n");
      out.write("<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">\r\n");
      out.write("<title>菜单管理信息</title>\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("<link rel=\"stylesheet\" type=\"text/css\" href=\"");
      out.print(request.getContextPath() );
      out.write("/resources/icon/icon.css?3\">\r\n");
      out.write("<link rel=\"stylesheet\" type=\"text/css\" href=\"");
      out.print(request.getContextPath() );
      out.write("/resources/easyui/themes/default/easyui.css\">\r\n");
      out.write("<link rel=\"stylesheet\" type=\"text/css\" href=\"");
      out.print(request.getContextPath() );
      out.write("/resources/easyui/themes/icon.css\">\r\n");
      out.write("<script type=\"text/javascript\" src=\"");
      out.print(request.getContextPath() );
      out.write("/resources/easyui/jquery-1.10.2.min.js\"></script>\r\n");
      out.write("<script type=\"text/javascript\" src=\"");
      out.print(request.getContextPath() );
      out.write("/resources/easyui/jquery.easyui.min.js\"></script>\r\n");
      out.write("<script type=\"text/javascript\" src=\"");
      out.print(request.getContextPath() );
      out.write("/resources/easyui/locale/easyui-lang-zh_CN.js\"></script>\r\n");
      out.write("<style type=\"text/css\">\r\n");
      out.write("\t.mask {  \r\n");
      out.write("            position: absolute; top: 0px; filter: alpha(opacity=60); background-color: #777;\r\n");
      out.write("            z-index: 1002; left: 0px;\r\n");
      out.write("            opacity:0.5; -moz-opacity:0.5;\r\n");
      out.write("        }\r\n");
      out.write("</style>\r\n");
      out.write("<script type=\"text/javascript\">\r\n");
      out.write("\t function getPageArea() {\r\n");
      out.write("\t\tif (document.compatMode == 'BackCompat') {\r\n");
      out.write("\t\t\treturn {\r\n");
      out.write("\t\t\t\twidth: Math.max(document.body.scrollWidth, document.body.clientWidth),\r\n");
      out.write("\t\t\t\theight: Math.max(document.body.scrollHeight, document.body.clientHeight)\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t} else {\r\n");
      out.write("\t\t\treturn {\r\n");
      out.write("\t\t\t\twidth: Math.max(document.documentElement.scrollWidth, document.documentElement.clientWidth),\r\n");
      out.write("\t\t\t\theight: Math.max(document.documentElement.scrollHeight, document.documentElement.clientHeight)\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t}\r\n");
      out.write("\t}\r\n");
      out.write("\tjQuery.extend({ \r\n");
      out.write("\t\tshowMask: function(el, msg) {\r\n");
      out.write("\t\t\tif(!el)el =document.body;\r\n");
      out.write("\t\t\tvar _1c3=$(el);\r\n");
      out.write("\t\t\tmsg = msg?msg:\"\";\r\n");
      out.write("\t\t\tif(!_1c3.children(\"div.datagrid-mask\").length){\r\n");
      out.write("\t\t\t\t$(\"<div class=\\\"datagrid-mask\\\" style=\\\"display:block\\\"></div>\").appendTo(_1c3);\r\n");
      out.write("\t\t\t\tvar msg=$(\"<div class=\\\"datagrid-mask-msg\\\" style=\\\"display:block;left:50%\\\"></div>\").html(msg).appendTo(_1c3);\r\n");
      out.write("\t\t\t\tmsg.css(\"marginLeft\",-msg.outerWidth()/2);\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t}, \r\n");
      out.write("\t\thideMask: function(el){ \r\n");
      out.write("\t\t\tif(!el)el =document.body;\r\n");
      out.write("\t\t   var _1c4=$(el);\r\n");
      out.write("\t\t   \tvar mask = _1c4.children(\"div.datagrid-mask-msg\");\r\n");
      out.write("\t\t   \tif(mask){\r\n");
      out.write("\t\t   \t\t_1c4.children(\"div.datagrid-mask-msg\").remove();\r\n");
      out.write("\t\t\t\t_1c4.children(\"div.datagrid-mask\").remove();\r\n");
      out.write("\t\t   \t}\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t} \r\n");
      out.write("\t});\r\n");
      out.write("</script>");
      out.write("\r\n");
      out.write("</head>\n");
      out.write("<script type=\"text/javascript\">\r\n");
      out.write("var menulist = \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${_adminUser_.btnMap.menulist}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("\"?true:false;\r\n");
      out.write("var menudoupdate = \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${_adminUser_.btnMap.menudoupdate}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("\"?true:false;\r\n");
      out.write("var menudoadd = \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${_adminUser_.btnMap.menudoadd}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("\"?true:false;\r\n");
      out.write("var menudodel = \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${_adminUser_.btnMap.menudodel}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("\"?true:false;\r\n");
      out.write("var hostpath = \"");
      out.print(request.getContextPath() );
      out.write("\";\r\n");
      out.write("function makeTreeData(menus,usecheck){\r\n");
      out.write("\r\n");
      out.write("\tif(menus.length==0)return menus;\r\n");
      out.write(" \t var mapdata = {};\r\n");
      out.write("\t  //第一次组织树节点内容\r\n");
      out.write("\t  for(var i=0;i<menus.length;i++)\r\n");
      out.write("\t  {\r\n");
      out.write("\t      var node = menus[i];\r\n");
      out.write("\t      var menuname = node['name'];\r\n");
      out.write("\t      var pid = node['pid'];\r\n");
      out.write("\t      var aid = node['id'] ;\r\n");
      out.write("\t      \r\n");
      out.write("\t      var path = node['path'];\r\n");
      out.write("\t      var isbutton = node['isbutton'];\r\n");
      out.write("\t      var btnflag = node[\"btnflag\"];\r\n");
      out.write("\t\t\tvar obj = {\r\n");
      out.write("\t    \t\t  id:aid,\r\n");
      out.write("\t    \t\t  text:menuname,\r\n");
      out.write("\t    \t\t // \"iconCls\":isbutton!=1?\"tree-file\":\"icon-add\",\r\n");
      out.write("\t    \t\t  \r\n");
      out.write("\t    \t\t  attributes:{\r\n");
      out.write("\t    \t\t  \tpath:path,\r\n");
      out.write("\t    \t\t  \tisbutton:isbutton,\r\n");
      out.write("\t    \t\t  \tbtnflag:btnflag,\r\n");
      out.write("\t    \t\t  \tpid:pid\r\n");
      out.write("\t    \t\t  }\r\n");
      out.write("\t    \t\t  \r\n");
      out.write("\t    \t\t};\r\n");
      out.write("\t    \t\tif(isbutton==1){\r\n");
      out.write("\t    \t\t\tobj['iconCls'] = 'icon-add';\r\n");
      out.write("\t    \t\t}\r\n");
      out.write("\t      mapdata[\"id_\"+aid]= obj;\r\n");
      out.write("\t     if(usecheck)\r\n");
      out.write("\t\t {\r\n");
      out.write("\t\t \tmapdata[\"id_\"+aid]['checked']=false;\r\n");
      out.write("\t\t }\r\n");
      out.write("\r\n");
      out.write("\t  }\r\n");
      out.write("  var ret = [];\r\n");
      out.write("  for(var key in mapdata)\r\n");
      out.write("  {\r\n");
      out.write("      var node = mapdata[key];\r\n");
      out.write("      var pid = mapdata[key]['attributes']['pid'];\r\n");
      out.write("      if(mapdata[\"id_\"+pid])\r\n");
      out.write("      {\r\n");
      out.write("          if(typeof mapdata[\"id_\"+pid]['children'] == 'undefined')\r\n");
      out.write("          {\r\n");
      out.write("              mapdata[\"id_\"+pid]['children'] = [];\r\n");
      out.write("          }\r\n");
      out.write("          mapdata[\"id_\"+pid]['children'].push(mapdata[key]);\r\n");
      out.write("      }else\r\n");
      out.write("      {\r\n");
      out.write("          ret.push(mapdata[key]);\r\n");
      out.write("      }\r\n");
      out.write("  }\r\n");
      out.write("  return ret;\r\n");
      out.write("}\r\n");
      out.write(" \r\n");
      out.write("function disableBtn(){\r\n");
      out.write("\t$(\"#cancleBtn\").attr('disabled','disabled');\r\n");
      out.write("\t$(\"#saveBtn\").attr('disabled','disabled');\r\n");
      out.write("\r\n");
      out.write("}\r\n");
      out.write("function enableableBtn(){\r\n");
      out.write("\t$(\"#cancleBtn\").removeAttr(\"disabled\");\r\n");
      out.write("\t$(\"#saveBtn\").removeAttr(\"disabled\");\r\n");
      out.write("\t\r\n");
      out.write("}\r\n");
      out.write("</script>\r\n");
      out.write("<body class=\"easyui-layout\"> \r\n");
      out.write("\t<div data-options=\"region:'center'\">\r\n");
      out.write("\t\t<div style=\"border:1px solid #ddd;text-align:right;position: fixed;width: 100%;margin-left: -30px;\">\r\n");
      out.write("\t\t\t<a href=\"#\" id=\"addBtn\" onclick=\"addFn()\" class=\"easyui-linkbutton\" data-options=\"plain:true,iconCls:'add_btn'\">增加</a>\r\n");
      out.write("\t\t\t<a href=\"#\"  id=\"delBtn\" onclick=\"deleteFn()\"  id= \"delBtn\" class=\"easyui-linkbutton\" data-options=\"plain:true,iconCls:'del_btn'\">删除</a>\r\n");
      out.write("\t\t\t<a href=\"#\"  id=\"updateBtn\" onclick=\"updateFn()\" class=\"easyui-linkbutton\" data-options=\"plain:true,iconCls:'update_btn'\">修改</a>\r\n");
      out.write("\t\t</div>\r\n");
      out.write("\t\t<ul id=\"tt\" style=\"width:100%;margin-top: 30px;\"></ul>\r\n");
      out.write("\t</div>\r\n");
      out.write("\t<!--  弹出窗口 -->\r\n");
      out.write("\t <div id=\"w\" class=\"easyui-window\" title=\"Modal Window\" data-options=\"modal:true,closed:true,iconCls:'icon-save',collapsible:false,minimizable:false,maximizable:false,resizable:false\" style=\"width:500px;height:400px;padding:10px;\">\r\n");
      out.write("\t\t<div class=\"easyui-layout\" data-options=\"fit:true\">\r\n");
      out.write("\t\t\t\t<div data-options=\"region:'center',border:false\" style=\"padding:10px;\">\r\n");
      out.write("\t\t\t\t\t\t<form id=\"ff\" method=\"post\">\r\n");
      out.write("\t\t\t\t\t    \t<table>\r\n");
      out.write("\t\t\t\t\t    \t\t<tr   style=\"display: none;\">\r\n");
      out.write("\t\t\t\t\t    \t\t\t<td>菜单id:</td>\r\n");
      out.write("\t\t\t\t\t    \t\t\t<td><input class=\"easyui-validatebox\"  style=\"width:250px;\" type=\"text\"  id=\"id\" name=\"id\" data-options=\"required:false\"></input></td>\r\n");
      out.write("\t\t\t\t\t    \t\t</tr>\r\n");
      out.write("\t\t\t\t\t    \t\t<tr>\r\n");
      out.write("\t\t\t\t\t    \t\t\t<td>上级菜单:</td>\r\n");
      out.write("\t\t\t\t\t    \t\t\t<td>\r\n");
      out.write("\t\t\t\t\t    \t\t\t\t<input class=\"easyui-combotree\" \r\n");
      out.write("\t\t\t\t\t    \t\t\t\t\tdata-options=\"editable:false,required:true\"\r\n");
      out.write("\t\t\t\t\t    \t\t\t\t\tid=\"parentMenu\"\r\n");
      out.write("\t\t\t\t\t    \t\t\t\t\tstyle=\"width:250px;\">\r\n");
      out.write("\t\t\t\t\t    \t\t\t</td>\r\n");
      out.write("\t\t\t\t\t    \t\t</tr>\r\n");
      out.write("\t\t\t\t\t    \t\t<tr>\r\n");
      out.write("\t\t\t\t\t    \t\t\t<td>名称:</td>\r\n");
      out.write("\t\t\t\t\t    \t\t\t<td><input class=\"easyui-validatebox\" style=\"width:250px;\"  type=\"text\" id=\"name\" name=\"name\" data-options=\"required:true\"></input></td>\r\n");
      out.write("\t\t\t\t\t    \t\t</tr>\r\n");
      out.write("\t\t\t\t\t    \t\t<tr >\r\n");
      out.write("\t\t\t\t\t    \t\t\t<td>类型:</td>\r\n");
      out.write("\t\t\t\t\t    \t\t\t<td><select class=\"easyui-combobox\" style=\"width:250px;\" id=\"isbutton\"  name=\"isbutton\"  data-options=\"editable:false,panelHeight: 'auto',onChange:onChangeFn\">\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t<option value=\"0\" selected=\"selected\">菜单</option>\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t<option value=\"1\">按钮</option>\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t</select>\r\n");
      out.write("\t\t\t\t\t\t\t\t</tr>\r\n");
      out.write("\t\t\t\t\t    \t\t<tr id=\"menu_path_tr\" >\r\n");
      out.write("\t\t\t\t\t    \t\t\t<td>路径:</td>\r\n");
      out.write("\t\t\t\t\t    \t\t\t<td><input class=\"easyui-validatebox\" style=\"width:250px;\"  type=\"text\"  id=\"path\" name=\"path\" data-options=\"required:false\"></input></td>\r\n");
      out.write("\t\t\t\t\t    \t\t</tr>\r\n");
      out.write("\t\t\t\t\t    \t\t<tr id=\"btn_code_tr\" style=\"display: none;\">\r\n");
      out.write("\t\t\t\t\t    \t\t\t<td>按钮编码:</td>\r\n");
      out.write("\t\t\t\t\t    \t\t\t<td><input class=\"easyui-validatebox\"  style=\"width:250px;\" type=\"text\"  id=\"btnflag\" name=\"btnflag\" data-options=\"required:false\"></input></td>\r\n");
      out.write("\t\t\t\t\t    \t\t</tr>\r\n");
      out.write("\t\t\t\t\t    \t\t\r\n");
      out.write("\t\t\t\t\t    \t</table>\r\n");
      out.write("\t\t\t\t\t    </form>\r\n");
      out.write("\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t<div data-options=\"region:'south',border:false\" style=\"text-align:right;padding:5px 0 0;\">\r\n");
      out.write("\t\t\t\t\t<a class=\"easyui-linkbutton\" data-options=\"iconCls:'icon-ok'\" href=\"javascript:void(0)\" id=\"saveBtn\" onclick=\"javascript:submitForm()\">保存</a>\r\n");
      out.write("\t\t\t\t\t<a class=\"easyui-linkbutton\" data-options=\"iconCls:'icon-cancel'\" href=\"javascript:void(0)\" id=\"cancleBtn\" onclick=\"javascript:closeWinFn()\">取消</a>\r\n");
      out.write("\t\t\t\t</div>\r\n");
      out.write("\t\t</div>\r\n");
      out.write("\t\t\r\n");
      out.write("\t</div>\r\n");
      out.write("</body>\r\n");
      out.write("<script type=\"text/javascript\">\r\n");
      out.write("\t\r\n");
      out.write("\t/***/\r\n");
      out.write("\tvar type = 'menu';\r\n");
      out.write("\twindow.treeData = [];\r\n");
      out.write("\t$(function(){\r\n");
      out.write("\t\t\tif(!menudoadd){\r\n");
      out.write("\t\t\t\t$(\"#addBtn\").attr(\"disabled\",true);\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t\tif(!menudoupdate){\r\n");
      out.write("\t\t\t\t$(\"#updateBtn\").hide();\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t\tif(!menudodel){\r\n");
      out.write("\t\t\t\t$(\"#delBtn\").hide();\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t$('#tt').tree({\r\n");
      out.write("\t\t\t    url: hostpath+'/admin/menu/list',\r\n");
      out.write("\t\t\t    method: 'get',\r\n");
      out.write("\t\t\t\tanimate: true,\r\n");
      out.write("\t\t\t\tonBeforeLoad: function(node, param){\r\n");
      out.write("\t\t\t\t\tparam['date'] = new Date().getTime();\r\n");
      out.write("\t\t\t\t},\r\n");
      out.write("\t\t\t    loadFilter: function(data){\r\n");
      out.write("\t\t\t    \twindow.treeData = data;\r\n");
      out.write("\t\t\t         return makeTreeData(data,false);\r\n");
      out.write("\t\t\t    }\r\n");
      out.write("\t\t\t});\r\n");
      out.write("\t});\r\n");
      out.write("\t\r\n");
      out.write("\t\r\n");
      out.write("var saveType=\"add\";\r\n");
      out.write("function addFn(){\r\n");
      out.write("\tinitFn();\r\n");
      out.write("\tsaveType = \"add\";\r\n");
      out.write("\tvar data = window.treeData;\r\n");
      out.write("\t $('#w').window('open').panel('setTitle',\"增加菜单\");\r\n");
      out.write("\t var menus = []; for(var i=0;i<data.length;i++){ if(data[i]['isbutton']!= 1){ menus.push(data[i]); } }\r\n");
      out.write("\t var tree2Data = makeTreeData(menus,false);\r\n");
      out.write("\tvar  newTree2Data = [{\r\n");
      out.write("\t\t\"id\":0,\r\n");
      out.write("\t\t\"text\":\"根目录\",\r\n");
      out.write("\t\t\"children\":tree2Data\r\n");
      out.write("\t}];\r\n");
      out.write("\t $('#parentMenu').combotree('loadData',newTree2Data);\r\n");
      out.write("\t $('#parentMenu').combotree('setValue',0);\r\n");
      out.write("}\r\n");
      out.write("function closeWinFn()\r\n");
      out.write("{\r\n");
      out.write("\t$('#w').window('close');\r\n");
      out.write("}\r\n");
      out.write("function onChangeFn(newValue, oldValue){\r\n");
      out.write("\tif(newValue == 0){\r\n");
      out.write("\t\ttype = 'menu';\r\n");
      out.write("\t\t//$(\"#menu_path_tr\").show();\r\n");
      out.write("\t\t$(\"#btn_code_tr\").hide();\r\n");
      out.write("\t\t\r\n");
      out.write("\t}else if(newValue == 1){\r\n");
      out.write("\t\ttype = 'button';\r\n");
      out.write("\t\t//$(\"#menu_path_tr\").hide();\r\n");
      out.write("\t\t$(\"#btn_code_tr\").show();\r\n");
      out.write("\t}\r\n");
      out.write("\r\n");
      out.write("}\r\n");
      out.write("function initFn(){\r\n");
      out.write("\t \r\n");
      out.write("\t\ttype = 'menu';\r\n");
      out.write("\t\t$(\"#menu_path_tr\").show();\r\n");
      out.write("\t\t$(\"#btn_code_tr\").hide();\r\n");
      out.write("\t\t$('#ff').form('reset');\r\n");
      out.write("\t\t\r\n");
      out.write("}\r\n");
      out.write("function submitForm(){\r\n");
      out.write(" \r\n");
      out.write("\tvar id = $(\"#id\").val();\r\n");
      out.write("\tvar pid =  $('#parentMenu').combotree('getValue');\r\n");
      out.write("\tvar name =  $('#name').val();\r\n");
      out.write("\tvar isbutton = $('#isbutton').combo('getValue');\r\n");
      out.write("\tvar path = $(\"#path\").val();\r\n");
      out.write("\tvar btnflag = $(\"#btnflag\").val();\r\n");
      out.write("\t\r\n");
      out.write("\t \r\n");
      out.write("\tif($.trim(name).length==0){\r\n");
      out.write("\t\t$.messager.alert('系统提示','名称不能为空!','warning');\r\n");
      out.write("\t\treturn;\r\n");
      out.write("\t}\r\n");
      out.write("\tif(isbutton ==1 ){/**按钮*/\r\n");
      out.write("\t\r\n");
      out.write("\t\tif(saveType == 'update'){\r\n");
      out.write("\t\t\tvar node = $('#tt').tree(\"find\",id);\r\n");
      out.write("\t\t\t var isLeaf = $('#tt').tree('isLeaf',node.target);\r\n");
      out.write("\t\t\t if(!isLeaf){\r\n");
      out.write("\t\t\t \t$.messager.alert('系统提示','此菜单下有内容不能修改为按钮!','warning');\r\n");
      out.write("\t\t\t \treturn;\r\n");
      out.write("\t\t\t }\r\n");
      out.write("\t\t }\r\n");
      out.write("\t\tif($.trim(btnflag).length==0){\r\n");
      out.write("\t\t\t$.messager.alert('系统提示','按钮编码不能为空!','warning');\r\n");
      out.write("\t\t\treturn;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t}else {\r\n");
      out.write("\t\tbtnflag = \"\";\r\n");
      out.write("\t}\r\n");
      out.write("\t \r\n");
      out.write("\tif(saveType == 'add'){\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tvar url = hostpath+\"/admin/menu/doadd\";\r\n");
      out.write("\t\t $.ajax({\r\n");
      out.write("\t\t  \t  \t  type:'post',\r\n");
      out.write("\t\t\t\t  url: url,\r\n");
      out.write("\t\t\t\t  context: document.body,\r\n");
      out.write("\t\t\t\t  beforeSend:function(){\r\n");
      out.write("\t\t\t\t  \tdisableBtn();\r\n");
      out.write("\t\t\t\t  \tjQuery.showMask($(\"#w\")[0],\"正在保存中 ....\");\r\n");
      out.write("\t\t\t\t  \treturn true;\r\n");
      out.write("\t\t\t\t  },\r\n");
      out.write("\t\t\t\t  data:{\r\n");
      out.write("\t\t\t\t  \tname:name,\r\n");
      out.write("\t\t\t\t  \tisbutton:isbutton,\r\n");
      out.write("\t\t\t\t  \tbtnflag:btnflag,\r\n");
      out.write("\t\t\t\t  \tpath:path,\r\n");
      out.write("\t\t\t\t  \tpid:pid\r\n");
      out.write("\t\t\t\t  },\r\n");
      out.write("\t\t\t\t  success:function(json){\r\n");
      out.write("\t\t\t\t  \t enableableBtn();\r\n");
      out.write("\t\t\t\t  \t jQuery.hideMask($(\"#w\")[0]);\r\n");
      out.write("\t\t\t\t  \t if(!json){\r\n");
      out.write("\t\t\t\t  \t\t $.messager.alert('系统提示','保存失败,该按钮编码已经存在,请修改!','info',function(){\r\n");
      out.write("\t\t\t\t \t   \t\t \r\n");
      out.write("\t\t\t\t \t   \t});\r\n");
      out.write("\t\t\t\t \t   \treturn;\r\n");
      out.write("\t\t\t\t  \t }\r\n");
      out.write("\t\t\t\t \t// var json_str = JSON2.stringify(json);\r\n");
      out.write("\t\t\t\t \t  $('#tt').tree(\"reload\");\r\n");
      out.write("\t\t\t\t \t   $.messager.alert('系统提示','保存成功!','info',function(){\r\n");
      out.write("\t\t\t\t \t   \t\tcloseWinFn();\r\n");
      out.write("\t\t\t\t \t   });\r\n");
      out.write("\t\t\t\t \t    \r\n");
      out.write("\t\t\t \t   \t   \r\n");
      out.write("\t\t\t\t \t  \r\n");
      out.write("\t\t\t\t  },\r\n");
      out.write("\t\t\t\t  error:function(xhr,textStatus,errorThrown){\r\n");
      out.write("\t\t\t\t  \t enableableBtn();\r\n");
      out.write("\t\t\t\t  \tjQuery.hideMask($(\"#w\")[0]);\r\n");
      out.write("\t\t\t\t  \tvar responseText = xhr.responseText;\r\n");
      out.write("\t\t\t\t  \t$.messager.alert('系统提示','保存失败，请刷新后重试!','error');\r\n");
      out.write("\t\t\t\t  \r\n");
      out.write("\t\t\t\t  } \r\n");
      out.write("\t\t});\r\n");
      out.write("\t}else if(saveType == 'update') {\r\n");
      out.write("\t\tvar tree = $('#parentMenu').combotree('tree');\r\n");
      out.write("\t\tvar selNode = tree.tree(\"find\",pid);\r\n");
      out.write("\t\tif(pid == id){\r\n");
      out.write("\t\t\t$.messager.alert('系统提示','禁止向自身节点移动!','warning');\r\n");
      out.write("\t\t\treturn;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t\r\n");
      out.write("\t\ttry{\r\n");
      out.write("\t\t\tvar isError = false;\r\n");
      out.write("\t\t\tvar xxxnode = selNode;\r\n");
      out.write("\t\t\twhile( true ){\r\n");
      out.write("\t\t\t\tvar pNode = tree.tree(\"getParent\",xxxnode.target);\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\tif(pNode.id == id){\r\n");
      out.write("\t\t\t\t\tisError = true;\r\n");
      out.write("\t\t\t\t\tbreak;\r\n");
      out.write("\t\t\t\t}else if(pNode.id == 0){\r\n");
      out.write("\t\t\t\t\tbreak;\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\txxxnode = pNode;\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t\tif(isError){\r\n");
      out.write("\t\t\t\t$.messager.alert('系统提示','禁止向子节点移动!','warning');\r\n");
      out.write("\t\t\t\treturn;\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t}catch(e){\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t//数据入库\r\n");
      out.write("\t\tvar url = hostpath+\"/admin/menu/doupdate\";\r\n");
      out.write("\t  \t $.ajax({\r\n");
      out.write("\t  \t  \t  type:'post',\r\n");
      out.write("\t\t\t  url: url,\r\n");
      out.write("\t\t\t  context: document.body,\r\n");
      out.write("\t\t\t  beforeSend:function(){\r\n");
      out.write("\t\t\t\t  \tdisableBtn();\r\n");
      out.write("\t\t\t\t  \tjQuery.showMask($(\"#w\")[0],\"正在保存中 ....\");\r\n");
      out.write("\t\t\t\t  },\r\n");
      out.write("\t\t\t  data:{\r\n");
      out.write("\t\t\t  \tid:id,\r\n");
      out.write("\t\t\t  \tname:name,\r\n");
      out.write("\t\t\t\t  \tisbutton:isbutton,\r\n");
      out.write("\t\t\t\t  \tbtnflag:btnflag,\r\n");
      out.write("\t\t\t\t  \tpath:path,\r\n");
      out.write("\t\t\t\t  \tpid:pid\r\n");
      out.write("\t\t\t  \t\r\n");
      out.write("\t\t\t  },\r\n");
      out.write("\t\t\t  success:function(json){\r\n");
      out.write("\t\t\t  \t\t\r\n");
      out.write("\t\t\t  \t\tjQuery.hideMask($(\"#w\")[0]);\r\n");
      out.write("\t\t\t \t// var json_str = JSON2.stringify(json);\r\n");
      out.write("\t\t\t  \t\tenableableBtn();\r\n");
      out.write("\t\t\t \t//\t var json_str = JSON2.stringify(json);\r\n");
      out.write("\t\t\t \t\tif(!json){\r\n");
      out.write("\t\t\t\t  \t\t $.messager.alert('系统提示','保存失败,该按钮编码已经存在,请修改!','info',function(){\r\n");
      out.write("\t\t\t\t \t   \t\t \r\n");
      out.write("\t\t\t\t \t   \t});\r\n");
      out.write("\t\t\t\t \t   \treturn;\r\n");
      out.write("\t\t\t\t  \t }\r\n");
      out.write("\t\t\t \t \t $('#tt').tree(\"reload\");\r\n");
      out.write("\t\t\t \t \t $.messager.alert('系统提示','保存成功!','info');\r\n");
      out.write("\t\t \t   \t  \t $(\"div[class='messager-button']\").bind('click',function(){\r\n");
      out.write("\t\t\t\t\t\tcloseWinFn();\r\n");
      out.write("\t\t\t\t  \t});\r\n");
      out.write("\t\t\t  \t \r\n");
      out.write("\t\t\t  \r\n");
      out.write("\t\t\t  },\r\n");
      out.write("\t\t\t  error:function(xhr,textStatus,errorThrown){\r\n");
      out.write("\t\t\t  \t\t enableableBtn();\r\n");
      out.write("\t\t\t  \t\tjQuery.hideMask($(\"#w\")[0]);\r\n");
      out.write("\t\t\t\t  \tvar responseText = xhr.responseText;\r\n");
      out.write("\t\t\t\t  \t$.messager.alert('系统提示','保存失败，请刷新后重试!','error');\r\n");
      out.write("\t\t\t  \r\n");
      out.write("\t\t\t  } \r\n");
      out.write("\t\t\t}); \r\n");
      out.write("\t} \r\n");
      out.write("}\r\n");
      out.write("function updateFn(){\r\n");
      out.write("\t var node = $('#tt').tree('getSelected');\r\n");
      out.write("\t if(node == null){\r\n");
      out.write("\t \t$.messager.alert('系统提示','请选择要修改的菜单!','warning');\r\n");
      out.write("\t \treturn;\r\n");
      out.write("\t }\r\n");
      out.write("\t//alert(JSON2.stringify(node.attributes));\r\n");
      out.write("\tsaveType = \"update\";\r\n");
      out.write("\tvar data = window.treeData;\r\n");
      out.write("\t $('#w').window('open').panel('setTitle',\"修改菜单\");\r\n");
      out.write("\t \r\n");
      out.write("\t var menus = []; for(var i=0;i<data.length;i++){ if(data[i]['isbutton']!= 1){ menus.push(data[i]); } }\r\n");
      out.write("\t var tree2Data = makeTreeData(menus,false);\r\n");
      out.write("\t var  newTree2Data = [{\r\n");
      out.write("\t\t\"id\":0,\r\n");
      out.write("\t\t\"text\":\"根目录\",\r\n");
      out.write("\t\t\"children\":tree2Data\r\n");
      out.write("\t }];\r\n");
      out.write("\t $('#parentMenu').combotree('loadData',newTree2Data);\r\n");
      out.write("\t $('#parentMenu').combotree('setValue',node.attributes.pid);\r\n");
      out.write("\t $('#name').val(node.text);\r\n");
      out.write("\t $('#name').validatebox(\"validate\");\r\n");
      out.write("\t \r\n");
      out.write("\t var isbutton = node.attributes.isbutton\r\n");
      out.write("\t $('#isbutton').combobox('setValue',isbutton);\t\r\n");
      out.write("\t \r\n");
      out.write("\t if(isbutton == 0){\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t$(\"#btn_code_tr\").hide();\r\n");
      out.write("\t\t\r\n");
      out.write("\t}else if(isbutton == 1){\r\n");
      out.write("\t\t \r\n");
      out.write("\t\t\r\n");
      out.write("\t\t$(\"#btn_code_tr\").show();\r\n");
      out.write("\t}\r\n");
      out.write("\t$(\"#path\").val(node.attributes.path);\r\n");
      out.write("\t$(\"#btnflag\").val(node.attributes.btnflag);\r\n");
      out.write("\t$(\"#id\").val(node.id);\r\n");
      out.write("\t \r\n");
      out.write("\r\n");
      out.write("}\r\n");
      out.write("function deleteFn()\r\n");
      out.write("{\r\n");
      out.write(" \tvar node = $('#tt').tree('getSelected');\r\n");
      out.write("\t if(node == null){\r\n");
      out.write("\t \t$.messager.alert('系统提示','请选择要删除的菜单!','warning');\r\n");
      out.write("\t \treturn;\r\n");
      out.write("\t }\r\n");
      out.write("\t var isLeaf = $('#tt').tree('isLeaf',node.target);\r\n");
      out.write("\t if(!isLeaf){\r\n");
      out.write("\t \t$.messager.alert('系统提示','只能操作叶子节点!','warning');\r\n");
      out.write("\t \treturn;\r\n");
      out.write("\t }\r\n");
      out.write("\t $.messager.confirm('系统提示', '您确定要删除选择的节点吗?', function(r){\r\n");
      out.write("\t\t\t\tif (r){\r\n");
      out.write("\t\t\t\t\tdelIndb(node.id);\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t});\r\n");
      out.write("\t \r\n");
      out.write("}\r\n");
      out.write("function delIndb(nodeId){\r\n");
      out.write("\tvar url = hostpath+\"/admin/menu/dodel?d=\"+new Date().getTime();\r\n");
      out.write("\t\t$.ajax({\r\n");
      out.write("\t\t\t  url: url,\r\n");
      out.write("\t\t\t  context: document.body,\r\n");
      out.write("\t\t\t  beforeSend:function(){\r\n");
      out.write("\t\t\t  \t\t$(\"#delBtn\").attr('disabled','disabled');\r\n");
      out.write("\t\t\t\t  \r\n");
      out.write("\t\t\t\t },\r\n");
      out.write("\t\t\t  data:{\r\n");
      out.write("\t\t\t   id:nodeId\r\n");
      out.write("\t\t\t  },\r\n");
      out.write("\t\t\t  success:function(json){\r\n");
      out.write("\t\t\t\t \t $('#tt').tree(\"reload\");\r\n");
      out.write("\t\t\t\t \t $.messager.alert('系统提示','删除成功!','info',function(){\r\n");
      out.write("\t\t\t\t \t \t$(\"#delBtn\").removeAttr(\"disabled\");\r\n");
      out.write("\t\t\t\t \t });\r\n");
      out.write("\t\t\t \t   \t \r\n");
      out.write("\t\t\t  },\r\n");
      out.write("\t\t  error:function(xhr,textStatus,errorThrown){\r\n");
      out.write("\t\t  \tvar responseText = xhr.responseText;\r\n");
      out.write("\t\t  \t$.messager.alert('系统提示','删除失败，请刷新后重试!','error');\r\n");
      out.write("\t\t  \t$(\"#delBtn\").removeAttr(\"disabled\");\r\n");
      out.write("\t\t  \r\n");
      out.write("\t\t  } \r\n");
      out.write("\t\t});\r\n");
      out.write("\r\n");
      out.write("}\r\n");
      out.write("</script>\r\n");
      out.write("</html>");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try { out.clearBuffer(); } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
